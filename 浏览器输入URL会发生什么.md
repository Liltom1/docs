#### 浏览器输入URL会发生什么

##### 认识URL

三部分组成

`https://xiaoman.blog.csdn.net/category_11618172_2.html`

- `https`:访问协议
- `xiaoman.blog.csdn.net`:服务器名称简称域名
- `category_11618172_2.html`:资源路径

##### 第一步`DNS`查询，域名寻址

`DNS`将域名与`IP`映射，

1.先从浏览器中缓存的`DNS`中去查找真的的`IP`

2.在操作系统中去查看

3.本地hosts文件

4.向域名服务器去查找

向域名服务器去查找的查找规则

客户端

向本地`DNS`服务器查找

根域名服务器查找

顶级域名服务器

权威域名服务器查找

##### 第二部拿到`IP`地址会三次握手发送请求

options请求：遇到跨域情况先进行options预检请求，或者自定义请求头的时候会发送options预检请求

只有为post 请求头是`opponication json`时才会发送预检请求

##### 第三步浏览器缓存

- 强缓存

缓存服务器提供的一些资源（静态资源） 后台配置 可以设置缓存的事件 cache-control 与 expires

缓存的方法有两种

硬盘缓存

内存缓存 （多次刷新会存到内存缓存）

- 协商缓存

与服务器协商 

 last-modified 与 if-modified-since:设置时间是否可以对的上

`Etag`：设置版本号或者哈希值去进行缓存

`Etag`与 last-modified 共存时`Etag`优先级高 ，`Etag`适用于频繁请求的资源，last-modified适用于不频繁请的资源

##### 第四步四次挥手 断开链接 渲染页面

拿到资源后进行渲染，

`html`解析器把标签解析成`dom`树去渲染

`css`解析器会把`css`进行格式化 em单位转为`px`

 在渲染过程中会经常遇到回流与重绘

###### 回流 （首次渲染会触发）

- 首次渲染
- 浏览器窗口大小发生改变
- 元素尺寸或位置发生改变
- 元素内容变化（文字或图片）
- 字体大小变化
- 添加或删除可见的DOM元素
- 激活`css`伪类
- 查询某些属性或调用某些方法

###### 重绘

和颜色相关的会发生重绘color,background-color

解析JavaScript

`V8`引擎去解析 `js`代码先经过解析器解析成`AST`抽象语法树 ->生成字节码->再通过解释器边解析边执行（`JIT`）->编译器->将字节码解释成机器码010101再到`cpu`去运行

生成字节码的原因是兼容各种操作系统与硬件



`DNS`内容分发

从就近服务器寻找，一层一层递归找到原服务器地址，一层一层返回并进行缓存（异地灾备)

`CDN`工作过程在`DNS` 寻址过程中 在最后一步 就使用 权威域名服务器 查找，智能`DNS`从就近的服务器节点查找

`CDN`有负载均衡 某一台服务器过高会向就近服务器分流